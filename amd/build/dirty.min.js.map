{"version":3,"file":"dirty.min.js","sources":["../src/dirty.js"],"sourcesContent":["// amd/src/admindirty.js\ndefine(['jquery'], function($) {\n    return {\n        init: function() {\n            const form = document.getElementById('adminsettings');\n            if (!form) {\n                return;\n            }\n\n            // Snapshot initial state.\n            const initial = new Map();\n            $(form).find('input, select, textarea').each(function() {\n                const el = this;\n                if (!el.name) {\n                    return;\n                }\n                const val = (el.type === 'checkbox' || el.type === 'radio') ? el.checked : el.value;\n                initial.set(el.name, val);\n            });\n\n            /**\n             * Checks if any input, select, or textarea element within the specified form\n             * has been modified from its initial value.\n             * @returns {boolean} True if the form is dirty (has unsaved changes), false otherwise.\n             */\n            function isDirty() {\n                let dirty = false;\n                $(form).find('input, select, textarea').each(function() {\n                    const el = this;\n                    if (!el.name || !initial.has(el.name)) {\n                        return;\n                    }\n                    const now = (el.type === 'checkbox' || el.type === 'radio') ? el.checked : el.value;\n                    if (now != initial.get(el.name)) {\n                        dirty = true;\n                        return false;\n                    }\n                });\n                return dirty;\n            }\n\n            const register = form.querySelector('button.dixeo-register-button');\n            if (!register) {\n                return;\n            }\n\n            const needsRegistration = form.querySelector('.dixeo-register-instructions .needs-registration');\n            if (!needsRegistration) {\n                return;\n            }\n\n            const needsSaving = form.querySelector('.dixeo-register-instructions .needs-saving');\n            if (!needsSaving) {\n                return;\n            }\n\n            $(form).on('input change', () => {\n                register.disabled = isDirty();\n                if (isDirty()) {\n                    needsRegistration.classList.add('hidden');\n                    needsSaving.classList.remove('hidden');\n                } else {\n                    needsRegistration.classList.remove('hidden');\n                    needsSaving.classList.add('hidden');\n                }\n            });\n\n            register.addEventListener('click', (e) => {\n                e.preventDefault();\n                if (isDirty()) {\n                    return false;\n                } else {\n                    const href = register.dataset.url;\n                    if (href) {\n                        window.location.assign(href);\n                    }\n                }\n            });\n        }\n    };\n});\n"],"names":["define","$","init","form","document","getElementById","initial","Map","isDirty","dirty","find","each","el","this","name","has","type","checked","value","get","val","set","register","querySelector","needsRegistration","needsSaving","on","disabled","classList","add","remove","addEventListener","e","preventDefault","href","dataset","url","window","location","assign"],"mappings":"AACAA,qCAAO,CAAC,WAAW,SAASC,SACjB,CACHC,KAAM,iBACIC,KAAOC,SAASC,eAAe,qBAChCF,kBAKCG,QAAU,IAAIC,aAeXC,cACDC,OAAQ,SACZR,EAAEE,MAAMO,KAAK,2BAA2BC,MAAK,iBACnCC,GAAKC,SACND,GAAGE,OAASR,QAAQS,IAAIH,GAAGE,oBAGP,aAAZF,GAAGI,MAAmC,UAAZJ,GAAGI,KAAoBJ,GAAGK,QAAUL,GAAGM,QACnEZ,QAAQa,IAAIP,GAAGE,OACtBL,OAAQ,GACD,aAGRA,MA3BXR,EAAEE,MAAMO,KAAK,2BAA2BC,MAAK,iBACnCC,GAAKC,SACND,GAAGE,kBAGFM,IAAmB,aAAZR,GAAGI,MAAmC,UAAZJ,GAAGI,KAAoBJ,GAAGK,QAAUL,GAAGM,MAC9EZ,QAAQe,IAAIT,GAAGE,KAAMM,cAwBnBE,SAAWnB,KAAKoB,cAAc,oCAC/BD,sBAICE,kBAAoBrB,KAAKoB,cAAc,wDACxCC,+BAICC,YAActB,KAAKoB,cAAc,8CAClCE,cAILxB,EAAEE,MAAMuB,GAAG,gBAAgB,KACvBJ,SAASK,SAAWnB,UAChBA,WACAgB,kBAAkBI,UAAUC,IAAI,UAChCJ,YAAYG,UAAUE,OAAO,YAE7BN,kBAAkBI,UAAUE,OAAO,UACnCL,YAAYG,UAAUC,IAAI,cAIlCP,SAASS,iBAAiB,SAAUC,OAChCA,EAAEC,iBACEzB,iBACO,EACJ,OACG0B,KAAOZ,SAASa,QAAQC,IAC1BF,MACAG,OAAOC,SAASC,OAAOL"}